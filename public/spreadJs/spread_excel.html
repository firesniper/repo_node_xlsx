<!DOCTYPE HTML>
<html>
<head>
<meta charset='utf-8' />
<meta http-equiv='cache-control' content='no-cache' />
<meta name='viewport' content='width=device-width, height=device-height, user-scalable=no, initial-scale=1.0 ,minimum-scale=1.0,maximum-scale=1.0' />
<!-- SpreadJS语言设置（1）-->
    <meta name="spreadjs culture" content="zh-cn" />

    <!-- SpreadJS（2） -->
    <script src="js/gc.spread.sheets.all.10.1.0.min.js" type="text/javascript"></script>

    <!-- SpreadJS CSS（3）-->
    <link href="css/gc.spread.sheets.excel2013white.10.1.0.css" rel="stylesheet" type="text/css" />
    <link href= "css/spread_index.css" rel= "stylesheet" type= "text/css" />
</head>
<body>
    <div id="ss" style="width:100%; height:80vh"></div>
    <div class= "r_toolbar">
        <div class= "c_toolbar" >
            <p class= "btn_a01 btn_addSheet">add sheet</p>
            <p class= "btn_a01 btn_exportExcel">export Excel</p>
            
            <a class= "downloadExcel" href= "http://localhost:18080/downloads/fromJary.od.xlsx" >111</a>
        </div>
    </div>
    <div id= "jsonCode" ></div>
</body>
<script src= "js/jquery-1.9.0.custom.js" ></script>
<script src= "js/spread_init.js" ></script>
<script src= "js/spread_lib.js" ></script>
<script src= "json/init_sheet1.js" ></script>
<script src= "json/init_sheet2.js" ></script>
<script src= "js/parse_json.js" ></script>
<script src= "js/spread_init_sheet0_b.js" ></script>
<script src= "js/spread_input_sheet0_b.js" ></script>
<script src= "js/spread_init_sheet1_b.js" ></script>
<script src= "js/spread_input_sheet1_b.js" ></script>
<script src= "js/spread_input_actSheet.js" ></script>
<script src= "js/fn_ajax.js" ></script>
<script type="text/javascript">
document.addEventListener 
(
    "readystatechange" ,
    function ()
    {
        console.log ( "document.readyState:" , document.readyState ) ;
        if ( document.readyState == "interactive" )
        {
            /*var spread = 
            // $('#ss').data('workbook');
            new GC.Spread.Sheets.Workbook
            (
                document.getElementById("ss")
                ,
                {
                    // sheetCount : 3,//初始化为3个标签页
                    // newTabVisible : true //隐藏新建标签页按钮
                }
            ) ;*/
            
            // console.log ( "spread:" , spread ) ;
            
            // spread.options.tabStripVisible = false; 
            //Also you can set tabStripVisible to true.
            // spread.options.newTabVisible = false; 
            //Also you can set newTabVisible to true.
            $spread_lib.init 
            ( 
                { 
                    dom_workBookAnch : document.getElementById ( "ss" ) 
                } 
            ) ;
            
            if ( localStorage.str_spread_json )
            {
                $workBook.fromJSON ( JSON.parse ( localStorage.str_spread_json ) ) ;

            } ;

            spread_init_sheet0 ( /*{ pgp_spread : $workBook }*/ ) ;
            spread_input_sheet0 ( /*{ pgp_spread : $workBook }*/ ) ;
            console.log ( "window.pgp_plugin:" , window.pgp_plugin  ) ;
            spread_init_sheet1 ( /*{ pgp_spread : $workBook }*/ ) ;
            spread_input_sheet1 ( /*{ pgp_spread : $workBook }*/ ) ;
            spread_input_actSheet 
            (
                /*{
                    pgp_spread : pgp_spread 
                    
                }*/
            ) ;

        } ; 
    }
) ;
        window.onload = function () 
        {
            // SpreadJS 初始化
            // var spread = new GC.Spread.Sheets.Workbook(document.getElementById("ss"));
            /*var spread = new GC.Spread.Sheets.Workbook
            (
                document.getElementById("ss")
                ,
                {
                    // sheetCount : 3,//初始化为3个标签页
                    // newTabVisible : true //隐藏新建标签页按钮
                }
            ) ;*/
            
        } ;
             
</script>

<script type='text/javascript'></script>
</html>

